import{a as Z}from"./chunk-DO7L4RL7.js";import{a as D}from"./chunk-PTYYVVUA.js";import{a as P,c as j,d as U,e as L,f as B}from"./chunk-43BARLOT.js";import{$ as h,$b as Y,Da as u,Db as C,Ja as c,Jb as g,Kb as O,Lb as I,Mb as R,Na as r,Nb as q,Oa as s,Ob as $,Pa as f,Pb as z,Qb as H,Rb as J,Sa as S,Ta as m,Tb as K,Ua as v,Vb as Q,Wb as W,_b as X,aa as y,bb as d,cb as T,db as x,ea as b,fb as w,gb as M,sa as n,ta as p,xb as V,yb as F,za as _}from"./chunk-YQ56MUUY.js";var E=class a{toolbarOperation=new b;create(){this.toolbarOperation.emit({action_type:"create",data:null})}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=_({type:a,selectors:[["app-classes-toolbar"]],outputs:{toolbarOperation:"toolbarOperation"},decls:2,vars:0,consts:[[1,"btn",3,"click"]],template:function(t,i){t&1&&(r(0,"button",0),m("click",function(){return i.create()}),d(1,"Create"),s())},encapsulation:2})};function re(a,e){a&1&&(r(0,"div",15),d(1," Class Name is required "),s())}function ne(a,e){if(a&1&&(r(0,"div",16),f(1,"input",17),r(2,"label",18),d(3),s()()),a&2){let t=e.index,i=v();n(),c("formControlName",t)("id","section"+t),n(),c("for","section"+t),n(),x(" Section ",i.sections[t]," ")}}function le(a,e){a&1&&(r(0,"div",15),d(1," At least one section must be selected. "),s())}var N=class a{constructor(e,t,i,o){this.fb=e;this.service_sender=t;this.notification_service=i;this.loader_service=o;this.classForm=this.fb.group({name:["",$.required],sections:this.fb.array([],this.atLeastOneCheckboxSelectedValidator)}),this.addSections()}toolbarOperation=new b;heaeder_name;callsource;button;classForm;selectedDataItem=null;sections=["A","B","C","D","E","F","G"];set child_data({callsource:e,dataItem:t}){this.callsource=e,e=="create"?(this.heaeder_name="Add Class",this.button="Create"):(this.selectedDataItem=t,this.heaeder_name="Edit Class",this.button="Update",this.bind_form(t))}bind_form(e){this.classForm.patchValue({name:e.name});let t=this.sectionsFormArray;t.clear(),this.sections.forEach(i=>{t.push(this.fb.control(e.sections.includes(i)))})}get sectionsFormArray(){return this.classForm.get("sections")}addSections(){this.sections.forEach(()=>{this.sectionsFormArray.push(this.fb.control(!1))})}atLeastOneCheckboxSelectedValidator(e){return e.controls.some(i=>i.value===!0)?null:{noSelection:!0}}submitForm(){this.classForm.valid&&(this.callsource=="create"?this.addClass():this.updateClass())}addClass(){let e=this.classForm.value.sections.map((o,l)=>o?this.sections[l]:null).filter(o=>o!==null),t=g.baseUrl+"/class/add",i={name:this.classForm.value.name,sections:e};this.loader_service.loadingStart("classCurd","Please wait."),this.service_sender.makePostSeverCall(t,i).subscribe({next:o=>{this.loader_service.loadingStop("classCurd"),this.notification_service.notifier("success","New class added successfully."),this.toolbarOperation.emit({action_type:"created",data:o})},error:o=>{this.loader_service.loadingStop("classCurd")}})}updateClass(){let e=this.classForm.value.sections.map((o,l)=>o?this.sections[l]:null).filter(o=>o!==null),t=g.baseUrl+"/class/update/"+this.selectedDataItem._id,i={name:this.classForm.value.name,sections:e};this.loader_service.loadingStart("classCurd","Please wait ..."),this.service_sender.makePutSeverCall(t,i).subscribe({next:o=>{this.loader_service.loadingStop("classCurd"),this.selectedDataItem=o,this.notification_service.notifier("success","Class updated successfully."),this.toolbarOperation.emit({action_type:"updated",data:o})},error:o=>{this.loader_service.loadingStop("classCurd")}})}close(){this.toolbarOperation.emit({action_type:"close",data:null})}static \u0275fac=function(t){return new(t||a)(p(X),p(O),p(D),p(I))};static \u0275cmp=_({type:a,selectors:[["app-classes-curd"]],inputs:{child_data:"child_data"},outputs:{toolbarOperation:"toolbarOperation"},decls:21,vars:7,consts:[["id","classCurd",1,"mx-2","form-container"],[1,"d-flex","w-100","justify-content-between","align-items-center","py-2","bottom_border"],[1,"close-btn",3,"click"],[1,"bi","bi-x"],[1,"form-body"],[3,"formGroup"],[1,"form-group","mb-3"],["for","name"],["id","name","formControlName","name","placeholder","Enter class name",1,"form-control"],["class","text-danger mt-1",4,"ngIf"],["formArrayName","sections",1,"form-group","mb-3"],[1,"mb-2"],["class","form-check d-flex align-items-center",4,"ngFor","ngForOf"],[1,"btn-panel","d-flex","justify-content-end","py-2"],[1,"btn","btn-primary",3,"click","disabled"],[1,"text-danger","mt-1"],[1,"form-check","d-flex","align-items-center"],["type","checkbox",1,"form-check-input","me-2",3,"formControlName","id"],[1,"form-check-label",3,"for"]],template:function(t,i){if(t&1&&(r(0,"div",0)(1,"div",1)(2,"h6"),d(3),s(),r(4,"div",2),m("click",function(){return i.close()}),f(5,"i",3),s()(),r(6,"div",4)(7,"form",5)(8,"div",6)(9,"label",7),d(10,"Class Name"),s(),f(11,"input",8),u(12,re,2,0,"div",9),s(),r(13,"div",10)(14,"label",11),d(15,"Select Sections"),s(),u(16,ne,4,4,"div",12)(17,le,2,0,"div",9),s()()(),r(18,"div",13)(19,"button",14),m("click",function(){return i.submitForm()}),d(20),s()()()),t&2){let o,l;n(3),T(i.heaeder_name),n(4),c("formGroup",i.classForm),n(5),c("ngIf",((o=i.classForm.get("name"))==null?null:o.invalid)&&((o=i.classForm.get("name"))==null?null:o.touched)),n(4),c("ngForOf",i.sectionsFormArray.controls),n(),c("ngIf",((l=i.classForm.get("sections"))==null?null:l.hasError("noSelection"))&&((l=i.classForm.get("sections"))==null?null:l.touched)),n(2),c("disabled",i.classForm.invalid),n(),T(i.button)}},dependencies:[Y,J,q,R,z,H,K,W,Q,C,V,F],encapsulation:2})};function ce(a,e){if(a&1&&(r(0,"span"),d(1),s()),a&2){let t=e.dataItem;n(),x(" ",t.sections.join(","),"")}}function de(a,e){if(a&1){let t=S();r(0,"button",7),m("click",function(){let o=h(t).dataItem,l=v();return y(l.onEdit(o))}),d(1," Edit "),s(),r(2,"button",8),m("click",function(){let o=h(t).dataItem,l=v();return y(l.onDelete(o))}),d(3," Delete "),s()}}function me(a,e){a&1&&(r(0,"div",9)(1,"p"),d(2,"No Classes Available"),s()())}var k=class a{constructor(e,t,i,o){this.service_sender=e;this.service_msg=t;this.service_loader=i;this.notification_service=o}ngOnInit(){this.getClasses()}toolbarOperation=new b;set dataToAdd({dataItem:e}){e&&this.datasource_classes.push(e)}set data_to_update({dataItem:e}){e&&(this.datasource_classes=this.datasource_classes.map(t=>(t._id==e._id&&(t=e),t)))}datasource_classes=[];getClasses(){let e=g.baseUrl+"/class/getAll";this.service_loader.loadingStart("class_grid","Please wait."),this.service_sender.makeGetSeverCall(e,{}).subscribe({next:t=>{this.service_loader.loadingStop("class_grid"),this.datasource_classes=t},error:t=>{this.service_loader.loadingStop("class_grid")}})}onEdit(e){this.toolbarOperation.emit({action_type:"update",data:e})}onDelete(e){this.service_msg.confirm("Delete","Selected item will lost permanently. Do you want to continue?",[{label:"Delete",style:"danger",value:"delete"},{label:"Cancel",style:"secondary",value:"cancel"}]).then(t=>{t=="delete"&&this.delete_inner(e)})}delete_inner(e){let t=g.baseUrl+`/class/delete/${e._id}`;this.service_loader.loadingStart("class_grid","Please wait."),this.service_sender.makeDeleteSeverCall(t,{}).subscribe({next:i=>{this.service_loader.loadingStop("class_grid"),this.notification_service.notifier("success","Class deleted successfully."),this.datasource_classes=this.datasource_classes.filter(o=>o._id!=e._id)},error:i=>{this.service_loader.loadingStop("class_grid")}})}static \u0275fac=function(t){return new(t||a)(p(O),p(Z),p(I),p(D))};static \u0275cmp=_({type:a,selectors:[["app-classes-grid"]],inputs:{dataToAdd:[0,"data_to_add","dataToAdd"],data_to_update:"data_to_update"},outputs:{toolbarOperation:"toolbarOperation"},decls:8,vars:1,consts:[["id","class_grid"],[3,"gridData"],["field","name","title","Class Name"],["field","sections","title","Sections"],["reusableGridCellTemplate",""],["field","Action"],["noDataTemplate",""],["type","button",1,"btn","btn-sm","btn-success","me-2",3,"click"],["type","button",1,"btn","btn-sm","btn-danger",3,"click"],[1,"custom-no-data"]],template:function(t,i){t&1&&(r(0,"div",0)(1,"app-reusable-grid",1),f(2,"app-reusable-grid-column",2),r(3,"app-reusable-grid-column",3),u(4,ce,2,1,"ng-template",4),s(),r(5,"app-reusable-grid-column",5),u(6,de,4,0,"ng-template",4),s(),u(7,me,3,0,"ng-template",6),s()()),t&2&&(n(),c("gridData",i.datasource_classes))},dependencies:[C,P,B,U,j,L],styles:[".btn-success[_ngcontent-%COMP%]{background-color:#28a745;border-color:#28a745}.btn-success[_ngcontent-%COMP%]:hover{background-color:#218838;border-color:#1e7e34}.btn-danger[_ngcontent-%COMP%]{background-color:#dc3545;border-color:#dc3545}.btn-danger[_ngcontent-%COMP%]:hover{background-color:#c82333;border-color:#bd2130}"]})};var ee=a=>({dataItem:a}),pe=(a,e)=>({callsource:a,dataItem:e});function ue(a,e){if(a&1){let t=S();r(0,"div",6)(1,"app-classes-curd",7),m("toolbarOperation",function(o){h(t);let l=v();return y(l.toolbarOperation(o))}),s()()}if(a&2){let t=v();n(),c("child_data",M(1,pe,t.callsource,t.selectedDataItem))}}function _e(a,e){a&1&&f(0,"div",8)}var te=class a{display_right_panel=!1;data_to_add;selectedDataItem;data_to_update;callsource;toolbarOperation(e){e.action_type=="create"?(this.callsource="create",this.display_right_panel=!0):e.action_type=="close"?this.display_right_panel=!1:e.action_type=="created"?(this.display_right_panel=!1,this.data_to_add=e.data):e.action_type=="update"?(this.callsource="update",this.display_right_panel=!0,this.selectedDataItem=e.data):e.action_type=="updated"&&(this.display_right_panel=!1,this.data_to_update=e.data)}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=_({type:a,selectors:[["app-classes"]],decls:6,vars:8,consts:[[1,"mx-3"],[3,"toolbarOperation"],[1,"mt-2"],[3,"toolbarOperation","data_to_add","data_to_update"],["class","inner-right-panel",4,"ngIf"],["class","sliderOverlay",4,"ngIf"],[1,"inner-right-panel"],[3,"toolbarOperation","child_data"],[1,"sliderOverlay"]],template:function(t,i){t&1&&(r(0,"div",0)(1,"app-classes-toolbar",1),m("toolbarOperation",function(l){return i.toolbarOperation(l)}),s(),r(2,"div",2)(3,"app-classes-grid",3),m("toolbarOperation",function(l){return i.toolbarOperation(l)}),s()()(),u(4,ue,2,4,"div",4)(5,_e,1,0,"div",5)),t&2&&(n(3),c("data_to_add",w(4,ee,i.data_to_add))("data_to_update",w(6,ee,i.data_to_update)),n(),c("ngIf",i.display_right_panel),n(),c("ngIf",i.display_right_panel))},dependencies:[C,F,E,N,k],encapsulation:2})};export{te as ClassesComponent};
