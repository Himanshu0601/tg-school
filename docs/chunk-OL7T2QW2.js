import{a as se}from"./chunk-DO7L4RL7.js";import{a as G}from"./chunk-PTYYVVUA.js";import{a as B,c as R,d as $,f as H}from"./chunk-43BARLOT.js";import{$ as S,$b as ae,Cb as z,Da as d,Db as O,Ia as A,Ja as s,Jb as b,Kb as w,Lb as E,Na as a,Nb as J,Oa as r,Ob as u,Pa as m,Pb as K,Qb as Q,Rb as W,Sa as P,Sb as X,Ta as p,Tb as Y,Ua as v,Ub as Z,Vb as ee,Wb as te,Xa as _,Xb as ne,Yb as oe,Zb as re,_b as ie,aa as M,bb as l,cb as x,db as F,ea as h,fb as D,gb as U,hb as V,jb as L,sa as i,ta as f,xb as T,yb as y,za as g}from"./chunk-YQ56MUUY.js";var I=class o{toolbarOperation=new h;create(){this.toolbarOperation.emit({action_type:"create",data:null})}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=g({type:o,selectors:[["app-fees-toolbar"]],outputs:{toolbarOperation:"toolbarOperation"},decls:2,vars:0,consts:[[1,"btn",3,"click"]],template:function(t,n){t&1&&(a(0,"button",0),p("click",function(){return n.create()}),l(1,"Create"),r())},encapsulation:2})};function fe(o,e){if(o&1&&(a(0,"span",14),l(1),V(2,"date"),r()),o&2){let t=e.dataItem;i(),x(L(2,1,t.dueDate,"shortDate"))}}function _e(o,e){if(o&1&&(a(0,"div",3)(1,"h2",4)(2,"div",5)(3,"button",6),l(4),r()()(),a(5,"div",7)(6,"div",8)(7,"app-reusable-grid",9),m(8,"app-reusable-grid-column",10)(9,"app-reusable-grid-column",11),a(10,"app-reusable-grid-column",12),d(11,fe,3,4,"ng-template",13),r()()()()()),o&2){let t=e.$implicit,n=e.index;i(),_("id","heading",n,""),i(2),A("data-bs-target","#collapse"+n)("aria-controls","collapse"+n),i(),F(" ",t.name," "),i(),s("id","collapse"+n),A("aria-labelledby","heading"+n),i(2),s("gridData",t.feeGroups)}}function ge(o,e){o&1&&(a(0,"div",15)(1,"div",16),l(2,"No Fees Available."),r()())}var N=class o{constructor(e,t,n,c){this.service_sender=e;this.service_msg=t;this.service_loader=n;this.notification_service=c}ngOnInit(){this.getAllfeestr()}toolbarOperation=new h;set dataToAdd({dataItem:e}){e&&this.datasource_fees.push(e)}set data_to_update({dataItem:e}){e&&(this.datasource_fees=this.datasource_fees.map(t=>(t._id==e._id&&(t=e),t)))}datasource_fees=[];getAllfeestr(){let e=b.baseUrl+"/fee/feestructure/getAll";this.service_loader.loadingStart("feeTypeAccordion","Please wait."),this.service_sender.makeGetSeverCall(e,{}).subscribe({next:t=>{this.service_loader.loadingStop("feeTypeAccordion"),this.datasource_fees=t},error:t=>{this.service_loader.loadingStop("feeTypeAccordion")}})}onEdit(e){this.toolbarOperation.emit({action_type:"update",data:e})}onDelete(e){this.service_msg.confirm("Delete","Selected item will lost permanently. Do you want to continue?",[{label:"Delete",style:"danger",value:"delete"},{label:"Cancel",style:"secondary",value:"cancel"}]).then(t=>{t=="delete"&&this.delete_inner(e)})}delete_inner(e){let t=b.baseUrl+`/class/delete/${e._id}`;this.service_loader.loadingStart("feeTypeAccordion","Please wait."),this.service_sender.makeDeleteSeverCall(t,{}).subscribe({next:n=>{this.service_loader.loadingStop("feeTypeAccordion"),this.notification_service.notifier("success","Class deleted successfully."),this.datasource_fees=this.datasource_fees.filter(c=>c._id!=e._id)},error:n=>{this.service_loader.loadingStop("feeTypeAccordion")}})}static \u0275fac=function(t){return new(t||o)(f(w),f(se),f(E),f(G))};static \u0275cmp=g({type:o,selectors:[["app-fees-grid"]],inputs:{dataToAdd:[0,"data_to_add","dataToAdd"],data_to_update:"data_to_update"},outputs:{toolbarOperation:"toolbarOperation"},decls:3,vars:2,consts:[["id","feeTypeAccordion",1,"accordion"],["class","accordion-item border-0",4,"ngFor","ngForOf"],["class","no-data-container",4,"ngIf"],[1,"accordion-item","border-0"],[1,"accordion-header","d-flex","align-items-center","p-0",3,"id"],[1,"header-content","d-flex","align-items-center","w-100","p-2"],["type","button","data-bs-toggle","collapse","aria-expanded","false",1,"accordion-button","collapsed","custom-accordion-button","flex-grow-1","p-0"],["data-bs-parent","#feeTypeAccordion",1,"accordion-collapse","collapse",3,"id"],[1,"accordion-body","p-0"],[3,"gridData"],["field","feeType","title","Fee Type"],["field","amount","title","Amount"],["field","dueDate","title","Due Date"],["reusableGridCellTemplate",""],[1,"no-wrap"],[1,"no-data-container"],[1,"no-data-message"]],template:function(t,n){t&1&&(a(0,"div",0),d(1,_e,12,8,"div",1),r(),d(2,ge,3,0,"div",2)),t&2&&(i(),s("ngForOf",n.datasource_fees),i(),s("ngIf",n.datasource_fees.length==0))},dependencies:[O,T,y,z,B,H,$,R],styles:[".accordion-item[_ngcontent-%COMP%]{margin-bottom:10px}.accordion-button[_ngcontent-%COMP%]{box-shadow:none!important;background-color:transparent!important;padding-right:1.5rem;font-size:16px;font-weight:500;color:#495057;border:none;transition:color .3s,background-color .3s}.accordion-button[_ngcontent-%COMP%]:hover{color:#0d6efd}.accordion-button[_ngcontent-%COMP%]:after{content:none}.header-content[_ngcontent-%COMP%]{background-color:#f8f9fa;border-radius:5px;padding:10px 15px;display:flex;align-items:center;justify-content:space-between;transition:background-color .3s}.header-content[_ngcontent-%COMP%]:hover{background-color:#e9ecef}.accordion-header[_ngcontent-%COMP%]{padding:0;margin-bottom:0}.accordion-button[_ngcontent-%COMP%]:not(.collapsed){color:#0d6efd;font-weight:600;background-color:#e9ecef!important}.accordion-collapse.collapse.show[_ngcontent-%COMP%] + .accordion-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{background-color:#dee2e6}.accordion-body[_ngcontent-%COMP%]{padding:15px;background-color:#fff;border:1px solid #dee2e6;border-radius:5px;margin:5px 0}.no-data-container[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;align-items:center;min-height:150px;background-color:#f8f9fa;color:#6c757d;font-size:16px;font-weight:500;border:2px dashed #ced4da;border-radius:5px}.no-data-message[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#495057;text-align:center}.app-reusable-grid[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin:15px 0;font-size:14px;font-weight:500}.app-reusable-grid[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f8f9fa;text-align:left;padding:10px;border-bottom:2px solid #dee2e6}.app-reusable-grid[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px;border-bottom:1px solid #dee2e6}.app-reusable-grid[_ngcontent-%COMP%]   .no-wrap[_ngcontent-%COMP%]{white-space:nowrap}"]})};function ve(o,e){o&1&&(a(0,"div"),l(1,"Name is required."),r())}function be(o,e){o&1&&(a(0,"div"),l(1,"Name must be at least 3 characters long."),r())}function Ce(o,e){if(o&1&&(a(0,"div",21),d(1,ve,2,0,"div",22)(2,be,2,0,"div",22),r()),o&2){let t=v();i(),s("ngIf",t.name==null?null:t.name.hasError("required")),i(),s("ngIf",t.name==null?null:t.name.hasError("minLength"))}}function he(o,e){if(o&1&&(a(0,"option",23),l(1),r()),o&2){let t=e.$implicit;s("value",t._id),i(),F(" ",t.name," ")}}function ye(o,e){o&1&&(a(0,"div"),l(1,"Class is required."),r())}function Oe(o,e){if(o&1&&(a(0,"div",21),d(1,ye,2,0,"div",22),r()),o&2){let t=v();i(),s("ngIf",t.classField==null?null:t.classField.hasError("required"))}}function xe(o,e){if(o&1&&(a(0,"option",23),l(1),r()),o&2){let t=e.$implicit;s("value",t.name),i(),F(" ",t.name," ")}}function Fe(o,e){if(o&1){let t=P();a(0,"div",24)(1,"div",25)(2,"label",26),l(3,"Fee Type"),r(),a(4,"select",27)(5,"option",12),l(6,"Select Fee Type"),r(),d(7,xe,2,2,"option",13),r()(),a(8,"div",28)(9,"label",26),l(10,"Amount"),r(),m(11,"input",29),r(),a(12,"div",28)(13,"label",26),l(14,"Date"),r(),m(15,"input",30),r(),a(16,"button",31),p("click",function(){let c=S(t).index,C=v();return M(C.removeFeeGroup(c))}),m(17,"i",32),r()()}if(o&2){let t=e.index,n=v();s("formGroupName",t),i(2),_("for","feeType-",t,""),i(2),_("id","feeType-",t,""),i(3),s("ngForOf",n.feeTypes),i(2),_("for","amount-",t,""),i(2),_("id","amount-",t,""),i(2),_("for","date-",t,""),i(2),_("id","date-",t,"")}}var k=class o{constructor(e,t,n,c){this.fb=e;this.service_sender=t;this.notification_service=n;this.service_loader=c;this.feeForm=this.fb.group({name:["",[u.required]],class:["",u.required],feeGroups:this.fb.array([])})}toolbarOperation=new h;heaeder_name;callsource;button;selectedDataItem=null;feeForm;classOptions=[];feeTypes=[];ngOnInit(){this.getAllClasses(),this.getAllfeeType()}getAllClasses(){let e=b.baseUrl+"/class/getAll";this.service_loader.loadingStart("classCurd","Please wait."),this.service_sender.makeGetSeverCall(e,{}).subscribe({next:t=>{this.service_loader.loadingStop("classCurd"),this.classOptions=t},error:t=>{this.service_loader.loadingStop("classCurd")}})}getAllfeeType(){let e=b.baseUrl+"/fee/feetypes/getAll";this.service_loader.loadingStart("classCurd","Please wait."),this.service_sender.makeGetSeverCall(e,{}).subscribe({next:t=>{this.service_loader.loadingStop("classCurd"),this.feeTypes=t},error:t=>{this.service_loader.loadingStop("classCurd")}})}get feeGroups(){return this.feeForm.get("feeGroups")}get name(){return this.feeForm.get("name")}get classField(){return this.feeForm.get("class")}addFeeGroup(){let e=this.fb.group({feeType:["",u.required],amount:[0,[u.required,u.min(1)]],date:["",u.required]});this.feeGroups.push(e)}removeFeeGroup(e){this.feeGroups.removeAt(e)}set child_data({callsource:e,dataItem:t}){this.callsource=e,e=="create"?(this.heaeder_name="Add Fee Structure",this.button="Create"):(this.selectedDataItem=t,this.heaeder_name="Edit Fee Structure",this.button="Update",this.bind_form(t))}bind_form(e){if(e&&(this.feeForm.patchValue({name:e.name,class:e.class}),e.feeGroups&&e.feeGroups.length)){let t=e.feeGroups.map(c=>this.fb.group({feeType:[c.feeType,u.required],amount:[c.amount,[u.required,u.min(1)]],date:[c.date,u.required]})),n=this.fb.array(t);this.feeForm.setControl("feeGroups",n)}}submitForm(){let e=this.feeForm.value;if(!this.feeForm.valid){this.notification_service.notifier("error","Please fill all the required field.");return}this.callsource==="create"?this.create(e):this.edit(e)}create(e){let t=b.baseUrl+"/fee/feestructure/add";this.service_loader.loadingStart("classCurd","Please wait"),this.service_sender.makePostSeverCall(t,e).subscribe({next:n=>{this.service_loader.loadingStop("classCurd"),this.notification_service.notifier("success","Fee structure created successfully!"),this.toolbarOperation.emit({action_type:"created",data:n})},error:n=>{this.service_loader.loadingStop("classCurd"),this.notification_service.notifier("error","Error while creating fee structure.")}})}edit(e){let t=b.baseUrl+"/fee/feestructure/add";this.service_loader.loadingStart("classCurd","Please wait"),this.service_sender.makePostSeverCall(t,e).subscribe({next:n=>{this.service_loader.loadingStop("classCurd"),this.notification_service.notifier("success","Fee structure updated successfully!"),this.toolbarOperation.emit({action_type:"updated",data:n})},error:n=>{this.service_loader.loadingStop("classCurd"),this.notification_service.notifier("error","Error while creating fee structure.")}})}close(){this.toolbarOperation.emit({action_type:"close",data:null})}getErrorMessage(e,t){let n=t!==void 0?this.feeGroups.at(t).get(e):this.feeForm.get(e);return n?.hasError("required")?"This field is required":n?.hasError("minLength")?"Minimum 3 characters required":n?.hasError("min")?"Value must be greater than 0":""}static \u0275fac=function(t){return new(t||o)(f(ie),f(w),f(G),f(E))};static \u0275cmp=g({type:o,selectors:[["app-fees-curd"]],inputs:{child_data:"child_data"},outputs:{toolbarOperation:"toolbarOperation"},decls:29,vars:8,consts:[["id","classCurd",1,"mx-2","form-container"],[1,"d-flex","w-100","justify-content-between","align-items-center","py-2","bottom_border"],[1,"close-btn",3,"click"],[1,"bi","bi-x"],[1,"form-body","container"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","name"],["id","name","type","text","formControlName","name","placeholder","Enter name",1,"form-control"],["class","text-danger",4,"ngIf"],["for","class"],["id","class","formControlName","class",1,"form-control"],["value","","disabled",""],[3,"value",4,"ngFor","ngForOf"],["formArrayName","feeGroups",1,"fee-groups"],["class","fee-group-row",3,"formGroupName",4,"ngFor","ngForOf"],[1,"add-fee-group"],["type","button","title","Add Fee Group",1,"btn-icon","add-icon",3,"click"],[1,"bi","bi-plus"],[1,"btn-panel","d-flex","justify-content-end","py-2"],[1,"btn","btn-primary",3,"click","disabled"],[1,"text-danger"],[4,"ngIf"],[3,"value"],[1,"fee-group-row",3,"formGroupName"],[1,"form-group-inline","fee-type-group"],[3,"for"],["formControlName","feeType",1,"form-control",3,"id"],[1,"form-group-inline"],["type","number","formControlName","amount","placeholder","Amount",1,"form-control",3,"id"],["type","date","formControlName","date",1,"form-control",3,"id"],["type","button","title","Remove Fee Group",1,"btn-icon","remove-icon",3,"click"],[1,"bi","bi-trash"]],template:function(t,n){t&1&&(a(0,"div",0)(1,"div",1)(2,"h6"),l(3),r(),a(4,"div",2),p("click",function(){return n.close()}),m(5,"i",3),r()(),a(6,"div",4)(7,"form",5),p("ngSubmit",function(){return n.submitForm()}),a(8,"div",6)(9,"label",7),l(10,"Name"),r(),m(11,"input",8),d(12,Ce,3,2,"div",9),r(),a(13,"div",6)(14,"label",10),l(15,"Class"),r(),a(16,"select",11)(17,"option",12),l(18,"Select Class"),r(),d(19,he,2,2,"option",13),r(),d(20,Oe,2,1,"div",9),r(),a(21,"div",14),d(22,Fe,18,14,"div",15),r(),a(23,"div",16)(24,"button",17),p("click",function(){return n.addFeeGroup()}),m(25,"i",18),r()()()(),a(26,"div",19)(27,"button",20),p("click",function(){return n.submitForm()}),l(28),r()()()),t&2&&(i(3),x(n.heaeder_name),i(4),s("formGroup",n.feeForm),i(5),s("ngIf",(n.name==null?null:n.name.invalid)&&(n.name==null?null:n.name.touched)),i(7),s("ngForOf",n.classOptions),i(),s("ngIf",(n.classField==null?null:n.classField.invalid)&&(n.classField==null?null:n.classField.touched)),i(2),s("ngForOf",n.feeGroups.controls),i(5),s("disabled",n.feeForm.invalid),i(),x(n.button))},dependencies:[O,T,y,ae,W,oe,re,J,X,ne,K,Q,Y,te,Z,ee],styles:["#classCurd[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{background-color:#fff;border-radius:8px;box-shadow:0 2px 4px #0000001a}#classCurd[_ngcontent-%COMP%]   .fee-groups[_ngcontent-%COMP%]{margin-top:20px}#classCurd[_ngcontent-%COMP%]   .fee-group-row[_ngcontent-%COMP%]{position:relative;width:95%;padding:15px;border:1px solid #ddd;border-radius:5px;margin-bottom:15px;background-color:#f9f9f9;display:flex;flex-wrap:wrap}#classCurd[_ngcontent-%COMP%]   .fee-group-row[_ngcontent-%COMP%]   .form-group-inline[_ngcontent-%COMP%]{flex:1;margin-right:10px}#classCurd[_ngcontent-%COMP%]   .fee-group-row[_ngcontent-%COMP%]   .form-group-inline.fee-type-group[_ngcontent-%COMP%]{flex:2}#classCurd[_ngcontent-%COMP%]   .fee-group-row[_ngcontent-%COMP%]   .form-group-inline[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:12px;color:#555;margin-bottom:5px}#classCurd[_ngcontent-%COMP%]   .fee-group-row[_ngcontent-%COMP%]   .form-group-inline[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{height:35px;padding:5px 10px}#classCurd[_ngcontent-%COMP%]   .fee-group-row[_ngcontent-%COMP%]   .btn-icon.remove-icon[_ngcontent-%COMP%]{position:absolute;top:5px;right:-40px;display:flex;align-items:center;justify-content:center;background:none;border:none;font-size:18px;color:#dc3545;cursor:pointer;transition:color .2s}#classCurd[_ngcontent-%COMP%]   .fee-group-row[_ngcontent-%COMP%]   .btn-icon.remove-icon[_ngcontent-%COMP%]:hover{color:#b52a34}#classCurd[_ngcontent-%COMP%]   .add-fee-group[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:15px}#classCurd[_ngcontent-%COMP%]   .add-fee-group[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:40px;height:40px;border-radius:5px;background-color:#28a745;color:#fff;border:none;font-size:24px;cursor:pointer;transition:background-color .3s,transform .2s}#classCurd[_ngcontent-%COMP%]   .add-fee-group[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]:hover{background-color:#218838;transform:scale(1.1)}#classCurd[_ngcontent-%COMP%]   .add-fee-group[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]:active{background-color:#1e7e34}#classCurd[_ngcontent-%COMP%]   .btn-panel[_ngcontent-%COMP%]{margin-top:20px}#classCurd[_ngcontent-%COMP%]   .btn-panel[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:100px}"]})};var ce=o=>({dataItem:o}),Se=(o,e)=>({callsource:o,dataItem:e});function Me(o,e){if(o&1){let t=P();a(0,"div",6)(1,"app-fees-curd",7),p("toolbarOperation",function(c){S(t);let C=v();return M(C.toolbarOperation(c))}),r()()}if(o&2){let t=v();i(),s("child_data",U(1,Se,t.callsource,t.selectedDataItem))}}function Pe(o,e){o&1&&m(0,"div",8)}var de=class o{display_right_panel=!1;data_to_add;selectedDataItem;data_to_update;callsource;toolbarOperation(e){e.action_type=="create"?(this.callsource="create",this.display_right_panel=!0):e.action_type=="close"?this.display_right_panel=!1:e.action_type=="created"?(this.display_right_panel=!1,this.data_to_add=e.data):e.action_type=="update"?(this.callsource="update",this.display_right_panel=!0,this.selectedDataItem=e.data):e.action_type=="updated"&&(this.display_right_panel=!1,this.data_to_update=e.data)}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=g({type:o,selectors:[["app-fees"]],decls:6,vars:8,consts:[[1,"mx-3"],[3,"toolbarOperation"],[1,"mt-2"],[3,"toolbarOperation","data_to_add","data_to_update"],["class","inner-right-panel",4,"ngIf"],["class","sliderOverlay",4,"ngIf"],[1,"inner-right-panel"],[3,"toolbarOperation","child_data"],[1,"sliderOverlay"]],template:function(t,n){t&1&&(a(0,"div",0)(1,"app-fees-toolbar",1),p("toolbarOperation",function(C){return n.toolbarOperation(C)}),r(),a(2,"div",2)(3,"app-fees-grid",3),p("toolbarOperation",function(C){return n.toolbarOperation(C)}),r()()(),d(4,Me,2,4,"div",4)(5,Pe,1,0,"div",5)),t&2&&(i(3),s("data_to_add",D(4,ce,n.data_to_add))("data_to_update",D(6,ce,n.data_to_update)),i(),s("ngIf",n.display_right_panel),i(),s("ngIf",n.display_right_panel))},dependencies:[O,y,I,N,k],encapsulation:2})};export{de as FeesComponent};
